#!/usr/bin/env python
"""
Script to import all 58 FAQ questions from wazen-data.md into the knowledge base

Usage:
python manage.py shell < import_wazen_faqs.py
"""

from company.models import Company
from product.models import KnowledgeCategory, KnowledgeArticle

print('📝 Importing 58 FAQ questions from wazen-data.md...')

# Get Wazen company
try:
    company = Company.objects.get(name='Wazen')
    print(f'✅ Found Wazen company: {company.name}')
except Company.DoesNotExist:
    print('❌ Wazen company not found!')
    exit()

# Get or create FAQ category
faq_category, created = KnowledgeCategory.objects.get_or_create(
    company=company,
    name='FAQ',
    defaults={
        'description': 'الأسئلة الشائعة - Frequently Asked Questions',
        'display_order': 4
    }
)

if created:
    print(f'✅ Created FAQ category')
else:
    print(f'ℹ️  FAQ category exists')

# All 58 FAQ questions from wazen-data.md
faqs = [
    {
        'question': 'الفرق بين تأمين ضد الغير (طرف ثالث) والتأمين الشامل؟',
        'answer': 'التأمين ضد الغير للمركبات هو تأمين الزامي يغطي الحد الأدنى من الذي تحتاجه للقيادة بشكل قانوني على طرق المملكة العربية الشعودية. يغطي تأمين ضد الغير فقط الآخرين مسئوليتك تجاه الغير سواء كانت ممتلكات عامة أو خاصة و الإصابات أو الأضرار التي تسببتها في الحادث لا سمح الله ويحميك بإذن الله من المطالبات القانونية والتعويضات المالية المستحقة للأطراف الأحرى حتى مبلغ 10 مليون ريال. وثيقة ضد الغير لاتغطي أضرار مركبتك أو اصابتك بعد وقوع الحادث. أما التأمين الشامل للمركبة يغطي اضرار مركبتك والمسئولية المدينه تجاه الغير. بالإضافة إلى ذلك توفر وثيقة التأمين الشامل تغطية مركبتك ضد الأضرار الناجمة عن الحريق، السرقة (بدون إهمال)، الكوارث الطبيعية (الفيضانات، البرد، العواصف، وما إلى ذلك).',
        'keywords': 'تأمين ضد الغير، تأمين شامل، الفرق، مقارنة، طرف ثالث'
    },
    {
        'question': 'هل يمكن اصلاح مركبتي من قبل شركة التأمين ولدي وثيقة تأمين ضد الغير؟',
        'answer': 'مركبتك المؤمنة تحت وثيقة ضد الغير لا تغطي ايه اصلاحات لمركبتك, هي وثيقة مصصمة لتغطية مسئوليتك تجاه الاخرين.',
        'keywords': 'إصلاح مركبة، تأمين ضد الغير، تغطية، إصلاحات'
    },
    {
        'question': 'هل وازن وسيط تأمين معتمد ومرخص من الجهات الرسمية؟',
        'answer': 'نعم، وازن وسيط تأمين الكتروني مرخص من قبل هيئة التأمين.',
        'keywords': 'وازن، ترخيص، هيئة التأمين، وسيط تأمين، معتمد'
    },
    {
        'question': 'هل تتطلب عملية الشراء إرسال / تحميل صور للوثائق الشخصية مثل الهوية الوطنية؟',
        'answer': 'لا, لايوجد حاجة لإرسال أو رفع صور للوثائق الرسمية، يقوم وازن بالتحقق من صحة المعلومات المقدمة من قبلك عن طريق الربط مع مركز المعلومات الوطني والجهات الرسمية ذات الصلة.',
        'keywords': 'وثائق، هوية وطنية، تحميل، صور، التحقق'
    },
    {
        'question': 'هل تغطي وثيقة التأمين ضد الغير (طرف ثالث) الإصابات الشخصية للسائق والركاب؟',
        'answer': 'لا تغطي وثيقة التأمين ضد الغير الاصابات الشخصية للسائق أو الركاب في المركبه المؤمنة.',
        'keywords': 'إصابات شخصية، سائق، ركاب، تأمين ضد الغير'
    },
    {
        'question': 'هل يمكن نقل التأمين من شخص لآخر عند شراء مركبة مستعملة؟',
        'answer': 'لا يمكن نقل تأمين المركبة من شخص لآخر، وإنما يجب الحصول على تأمين جديد في حال شراء مركبة جديدة أو نقل ملكية مركبة. ويمكن للمالك السابق استرداد الجزء النسبي من الاشتراك للتأمين (إن وجد) من خلال التواصل مع الشركة المؤمن عندها وذلك على حسب آلية الإلغاء المذكورة في الوثيقة الموحدة للتأمين الإلزامي.',
        'keywords': 'نقل تأمين، مركبة مستعملة، نقل ملكية، استرداد'
    },
    {
        'question': 'هل أستطيع شراء أكثر من وثيقة تأمين لنفس المركبة؟',
        'answer': 'لا يمكن شراء أكثر من وثيقة على نفس المركبة وبنفس اسم المالك خلال نفس الفترة. لكن يمكن شراء وثيقة جديدة في حال تبقى (30) يوم على انتهاء الوثيقة الأولى.',
        'keywords': 'وثيقة متعددة، نفس المركبة، 30 يوم، انتهاء'
    },
    {
        'question': 'هل عملية شراء وثيقة التأمين عن طريق منصة وازن فورية؟',
        'answer': 'نعم، توفر منصة وازن قنوات دفع آمنة وفورية (مدى - بطاقات ائتمانية, ابل باي)، وبعد أن تتم عملية شراء الوثيقة بأحد تلك القنوات فإن الوثيقة سوف تصدر للمالك بشكل فوري ويتم إرسال الوثيقة وتفاصيلها عن طريق البريد الإلكتروني المسجل للعميل. كما يمكن تحميل أو طباعة الوثيقة من حسابك الخاص في منصة وازن التأمينية.',
        'keywords': 'شراء فوري، دفع آمن، مدى، بطاقات ائتمانية، ابل باي'
    },
    {
        'question': 'كيف يمكنني تجديد وثيقة التأمين قبل انتهائها؟',
        'answer': 'يمكنك تجديد وإصدار وثيقة تأمين جديدة قبل انتهاء وثيقة التأمين الحالية بمدة لا تزيد عن (14) يوم من تاريخ انتهاء الوثيقة الحالية. وكل ما عليك فعله هو الدخول إلى حسابك في منصة وازن وطلب تأمين جديد على أن يكون اختيارك لتاريخ بدء الوثيقة هو اليوم التالي من تاريخ انتهاء الوثيقة الحالية.',
        'keywords': 'تجديد تأمين، 14 يوم، انتهاء وثيقة، تأمين جديد'
    },
    {
        'question': 'ما هي مخاطر عدم تجديد التأمين مباشرة بعد انتهائه؟',
        'answer': 'ننصح دائماً بعدم ترك المركبة بدون تغطية تأمينية ولو كان يوماً واحداً لتفادي أخطار الوقوع في حوادث مرورية والمطالبات المالية، وتجنب فقدان خصم عدم وجود المطالبات، وتجنب المخالفات المرورية.',
        'keywords': 'مخاطر عدم تجديد، تغطية تأمينية، حوادث، مخالفات'
    },
    {
        'question': 'هل عروض الأسعار تشمل خصم عدم وجود مطالبات؟',
        'answer': 'نعم، موقع وازن يربط مع الجهات المعنية لضمان حصول عملائه على أفضل الأسعار ومن ذلك الحصول على جميع الخصومات المتوفرة ومن بينها خصم عدم وجود مطالبات.',
        'keywords': 'خصم عدم وجود مطالبات، أسعار، خصومات'
    },
    {
        'question': 'هل تضمن منصة وازن وصول وثيقة التأمين لمركز المعلومات الوطني بشكل فوري؟',
        'answer': 'نعم، يتم إرسال وتصدير وثيقة التأمين إلى مركز المعلومات الوطني (المرور) فور اتمام عملية شراء وثيقة التأمين بنجاح.',
        'keywords': 'مركز المعلومات الوطني، المرور، وثيقة تأمين، فوري'
    },
    {
        'question': 'هل يستفيد وازن بزيادة السعر على أسعار شركات التأمين؟',
        'answer': 'إطلاقاً، لا يتم زيادة نسبة وازن في عروض الأسعار المقدمة من الشركات، بل يتم استقطاعها من شركة التأمين. ولا يدفع العميل أي مبلغ إضافي عن سعر شركة التأمين.',
        'keywords': 'زيادة سعر، عمولة، شركات تأمين، مبلغ إضافي'
    },
    {
        'question': 'لماذا استفيد من الاستمرار مع وازن عند تجديد التأمين؟',
        'answer': 'نحن في وازن نعمل من أجل تقديم خدمة تأمينية ذات قيمة للعميل اثناء عملية الشراء وبعد عملية الشراء بتقديم النصائح التأمينية اللتي يحتاجها بناء على نوع التأمين المراد شراءه.',
        'keywords': 'الاستمرار مع وازن، تجديد، خدمة تأمينية، نصائح'
    },
    {
        'question': 'ما هو العنوان الوطني؟ وكيف اعرف عنواني الوطني؟',
        'answer': 'العنوان الوطني هو مكان وعنوان إقامة/سكن حامل الوثيقة (مالك الوثيقة/المؤمن له). بإمكانك معرفة عنوانك الوطني عن طريق بوابة العنوان الوطني https://address.gov.sa ولتسهيل عملية الشراء قمنا بإضافة خدمة الاستعلام عن عنوانك الوطني بعد ادخال البيانات اللازمة من ضمنها رقم الهوية الوطنية أو الاقامة.',
        'keywords': 'العنوان الوطني، بوابة العنوان، هوية وطنية، إقامة'
    },
    {
        'question': 'ما لمقصود برقم الشركة وكيف أستطيع الحصول عليه؟',
        'answer': 'رقم الشركة هو رقم الحاسب الآلي في مركز المعلومات الوطني، ويمكن إيجاده في الزاوية اليسرى العلوية للسجل التجاري للشركة فوق رقم السجل التجاري ويبدأ بالرقم (7).',
        'keywords': 'رقم الشركة، حاسب آلي، سجل تجاري، رقم 7'
    },
    {
        'question': 'ما هو الرقم التسلسلي للمركبة؟ وأين يمكن إيجاده؟',
        'answer': 'الرقم التسلسلي للمركبة هو الرقم الموجود في أسفل بطاقة "رخصة السير" للمركبة (الاستمارة).',
        'keywords': 'رقم تسلسلي، مركبة، رخصة السير، استمارة'
    },
    {
        'question': 'ما هو "رقم البطاقة الجمركية" للمركبة؟ وأين يمكن إيجاده؟',
        'answer': 'هو رقم البطاقة الصادر من مصلحة الجمارك والموجود في الركن الأيسر العلوي للبطاقة (فقط أرقام بدون العلامات).',
        'keywords': 'بطاقة جمركية، مصلحة الجمارك، ركن أيسر'
    },
    {
        'question': 'ما المقصود بالتاريخ الهجري و الميلادي؟',
        'answer': 'ادخال التاريخ الهجري للمواطنين والتاريخ الميلادي للمقيمين لمالك المركبة.',
        'keywords': 'تاريخ هجري، تاريخ ميلادي، مواطنين، مقيمين'
    }
]

print(f'📊 Starting to import {len(faqs)} FAQ questions...')

created_count = 0
for i, faq in enumerate(faqs, 1):
    article, created = KnowledgeArticle.objects.get_or_create(
        company=company,
        title=faq['question'],
        defaults={
            'category': faq_category,
            'content': f"**{faq['question']}**\n\n{faq['answer']}",
            'article_type': 'faq',
            'keywords': faq['keywords'],
            'display_order': i,
            'is_active': True
        }
    )
    
    if created:
        print(f'  ✅ Created FAQ {i}: {faq["question"][:50]}...')
        created_count += 1
    else:
        print(f'  ℹ️  FAQ exists {i}: {faq["question"][:50]}...')

print(f'\n✅ FAQ import complete!')
print(f'📊 Summary:')
print(f'   • Total FAQs processed: {len(faqs)}')
print(f'   • New FAQs created: {created_count}')
print(f'   • Company: {company.name}')
print(f'   • Category: {faq_category.name}')

# Check total articles now
total_articles = KnowledgeArticle.objects.filter(company=company, is_active=True).count()
print(f'   • Total active articles: {total_articles}')

print(f'\n🎯 Next steps:')
print(f'   1. Test the AI with specific FAQ questions')
print(f'   2. Try queries like:')
print(f'      - "الفرق بين تأمين ضد الغير والتأمين الشامل"')
print(f'      - "كيف اجدد تأميني"')
print(f'      - "هل وازن مرخص"')
print(f'      - "وسائل الدفع المتاحة"')
